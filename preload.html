<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no"/>
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">

    <title>XXX-xxx</title>
    <link href="./css/awesome.css" rel="stylesheet">
    <link href="./css/base.css" rel="stylesheet">
    <link href="./css/common.css" rel="stylesheet">
    <link href="./css/iSlider.css" rel="stylesheet">
    <link href="./css/index.css" rel="stylesheet">
    
    <script type="text/javascript" src="./js/jquery1.10.2.js"></script>
    <script type="text/javascript" src="./js/fontSize.js"></script>
    <script type="text/javascript" src="./js/common.js"></script>
    <script type="text/javascript" src="./js/iSlider.js"></script>
    <script type="text/javascript" src="./js/iSlider.animate.js"></script>
    <script type="text/javascript" src="./js/iSlider.dot.js"></script>
    <script type="text/javascript" src="./js/iSlider.plugin.button.js"></script>
    <script type="text/javascript" src='./layer/layer.js'></script>
    <style>

    </style>
</head>
<body>
    <div>
        <!-- https://www.planwallpaper.com/static/images/violet-vector-leaves-circles-backgrounds-for-powerpoint_PdfkI4q.jpg -->
        <img class='preload' data-src="https://www.planwallpaper.com/static/images/violet-vector-leaves-circles-backgrounds-for-powerpoint_PdfkI4q.jpg" src='./img/test.png' alt="">

        <img class='preload' data-src="https://cdn.pixabay.com/photo/2018/01/04/19/43/desktop-background-3061483_960_720.jpg" src='./img/test.png' alt="">

        <img class='preload' data-src=https://images.unsplash.com/photo-1489551917489-bddbe72c6734?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=db2df8482936f5e4d0a7793ea504aa6d&auto=format&fit=crop&w=2134&q=80" src='./img/test.png' alt="">

        <img class='preload' data-src=https://images.unsplash.com/photo-1489551917489-bddbe72c6734?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=db2df8482936f5e4d0a7793ea504aa6d&auto=format&fit=crop&w=2134&q=80" src='./img/test.png' alt="">

        <img class='preload' data-src=https://images.unsplash.com/photo-1489551917489-bddbe72c6734?ixlib=rb-0.3.5&ixid=eyJhcHBfaWQiOjEyMDd9&s=db2df8482936f5e4d0a7793ea504aa6d&auto=format&fit=crop&w=2134&q=80" src='./img/test.png' alt="">
    </div>
</body>
<script>
    // $('.preload').each(function (index, ele) {
    //     console.log(index, ele);
    //     var imageObj = new Image();
    //     imageObj.src = ele.getAttribute('data-src');
    //     imageObj.onload = function () {
    //         console.log('OK', this.src);
    //         ele.setAttribute('src', this.src);
    //     };
    // });

/*
    图片预加载插件

 */


!function ($) {
    // 1 定义构造函数
    var PicPreloader = function (el) {
        this.el = el;
        this.reloadPic();
    };
    // 2 定义原型方法
    PicPreloader.prototype = {
        // 预加载后替换图片
        reloadPic: function () {
            console.log(this.el);
            var _this = this;
            this.imageObj = new Image();
            this.imageObj.src = this.el.attr('data-src');
            this.imageObj.onload = function () {
                _this.el.attr('src', _this.imageObj.src);
            };
        }
    };
    // 3 拓展jquery函数
    $.fn.extend({
        picPreloader: function () {
            this.each(function(){
                new PicPreloader($(this));
            });
            return $(this);
        } 
    });
}(jQuery);

$('.preload').picPreloader();

</script>
</html>